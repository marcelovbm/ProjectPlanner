$(document).ready(function(){$.ajax({url:"userNameLogin.php"}).done(function(msg){if(msg==="erro")window.location.replace("index.html");else{document.getElementById("userNameLogin").innerHTML=msg;$("#employee").click(function(){employee.listEmployee()});$("#project").click(function(){project.listproject()});$("#scrumTeam").click(function(){team.listTeam()});$("#backlog").click(function(){productBacklog.listProductBacklog()});$("#sprint").click(function(){sprint.listSprint()});$("#bugTraker").click(function(){bugTraker.listBugTraker()});
$("#meetings").click(function(){meeting.listMeeting();$(".ui.dropdown").dropdown()});$("#graphics").click(function(){document.getElementById("panel-heading").innerHTML="Graphics";charts.projectCharts()});$("#logoout").click(function(){$.ajax({url:"logout.php"}).done(function(){window.location.replace("http://localhost/projectPlan/index.html")}).fail(function(){console.log("error")})})}}).fail(function(){console.log("error")})});
function projectNotSelected(){if(document.getElementById("projectSelected").innerText=="Project Selected")return 1;else return 0}
var project={listproject:function(){$(".panel").removeClass("hide");document.getElementById("panel-heading").innerHTML="Project";document.getElementById("panel-body").innerHTML='<table class="table table-condensed" id="tableProject"></table><button id="addButton" class="btn btn-circle btn-lg" data-toggle="modal" data-target="#new-project">Add</button>';$.ajax({url:"project.php",dataType:"JSON",success:function(data){$("#tableProject").bootstrapTable({data:data,singleSelect:true,striped:true,detailView:true,
detailFormatter:"detailFormatter",columns:[{field:"state",checkbox:true},{field:"nameProject",title:"Name",align:"center",valign:"middle",sortable:true},{field:"productOwner",title:"Product Owner",align:"center",valign:"middle",sortable:true},{field:"projectManager",title:"Project Manager",align:"center",valign:"top",sortable:true},{field:"data",title:"End Date",align:"center",valign:"middle"},{field:"edit",title:"Edit",align:"center",valign:"middle"},{field:"delete",title:"Delete",align:"center",
valign:"middle"}]});$("#tableProject").bootstrapTable("hideLoading");$("#tableProject").on("check.bs.table",function(e,row){project.selectProject(row)});$("#tableProject").on("uncheck.bs.table",function(){document.getElementById("projectSelected").innerHTML="Project Selected"})}}).done(function(){$.ajax({url:"listEmployeeProjectProductOwner.php"}).done(function(employeeOwner){document.getElementById("inputProductOwner").innerHTML=employeeOwner;$.ajax({url:"listEmployeeProjectProjectManager.php"}).done(function(employee){document.getElementById("inputProjectManager").innerHTML=
employee}).fail(function(){console.log("error")})}).fail(function(){console.log("error")})}).fail(function(){console.log("error")})},selectProject:function(objProject){$("#projectSelected").removeClass("projectSelectedEmployee");document.getElementById("projectSelected").innerHTML=objProject.nameProject},editarProjeto:function(){var inputEditProjectName=$("#inputEditProjectName").val();var formData=$("#editarProject").serialize();var data="inputProjectName="+encodeURIComponent(inputEditProjectName)+
"&"+formData;$.ajax({url:"editarProjeto.php",type:"POST",data:data}).done(function(){console.log("success")}).fail(function(){console.log("error")}).alway(function(){project.listproject()})},modalEditarProject:function(idProject){var element=document.getElementById("editarProjectBody");$.ajax({url:"receberEditarProject.php",type:"POST",data:"name="+idProject}).done(function(msg){element.innerHTML=[msg];$("#editProject").modal("show")}).fail(function(){console.log("error")})},deletarProject:function(idProject){$("#deletar").modal("show");
$(document).ready(function(){$("#deletarYes").click(function(){$.ajax({url:"deleteProject.php",type:"POST",data:"name="+idProject,success:function(){project.listproject()}}).done(function(){document.getElementById("projectSelected").innerHTML="Project Selected"}).fail(function(){console.log("error")})})})},removerEditarProject:function(){document.getElementById("editProject").modal("hide");document.getElementById("editarProject").remove();project.listproject()},removerClassProject:function(){document.getElementById("myboxProjeto").classList.remove("alert-success").classList.add("hide");
document.getElementById("myboxProjeto").classList.remove("alert-danger").classList.add("hide");document.getElementById("divInputProjectName").classList.remove("has-error");document.getElementById("divInputProductOwner").classList.remove("has-error");document.getElementById("divStartDate").classList.remove("has-error");document.getElementById("divEndDate").classList.remove("has-error");document.getElementById("divInputProjectManager").classList.remove("has-error");project.listproject();document.getElementById("cadProjeto").each(function(){this.reset()})},
myCallAddProject:function(){document.getElementById("myboxProjeto").classList.remove("alert-success","hide");document.getElementById("myboxProjeto").classList.remove("alert-danger").classList.remove("hide");document.getElementById("divInputProjectName").classList.remove("has-error");document.getElementById("divInputProductOwner").classList.remove("has-error");document.getElementById("divStartDate").classList.remove("has-error");document.getElementById("divEndDate").classList.remove("has-error");document.getElementById("inputProjectDescription").classList.remove("has-error");
document.getElementById("divInputProjectManager").classList.remove("has-error");var formData=document.getElementById("cadProjeto").serialize();$.ajax({url:"addProject.php",type:"POST",dataType:"html",data:formData}).done(function(msg){if(msg=="<p><strong>Project Name</strong> n\u00e3o foi inserido!</p>"){document.getElementById("divInputProjectName").addClass("has-error");document.getElementById("myboxProjeto").html(msg).addClass("alert-danger").classList.remove("hide")}else if(msg=="<p><strong>Product Owner</strong> n\u00e3o foi inserido!</p>"){document.getElementById("divInputProductOwner").addClass("has-error");
document.getElementById("myboxProjeto").html(msg).addClass("alert-danger").classList.remove("hide")}else if(msg=="<p><strong>Project Manager</strong> n\u00e3o foi inserido!</p>"){$("#divInputProjectManager").addClass("has-error");$("#myboxProjeto").html(msg).addClass("alert-danger").removeClass("hide")}else if(msg=="<p><strong>Start date</strong> n\u00e3o foi inserido!</p>"){$("#divStartDate").addClass("has-error");$("#myboxProjeto").html(msg).addClass("alert-danger").removeClass("hide")}else if(msg==
"<p><strong>End date</strong> n\u00e3o foi inserido!</p>"){$("#diveEndtDate").addClass("has-error");$("#myboxProjeto").html(msg).addClass("alert-danger").removeClass("hide")}else if(msg=="<p><strong>Project j\u00e1 existe!</strong></p>")$("#myboxProjeto").html(msg).addClass("alert-danger").removeClass("hide");else if(msg=="<p><strong>Project cadastrado com sucesso!</strong></p>"){$("#myboxProjeto").html(msg).addClass("alert-success").removeClass("hide");$("#cadProjeto").each(function(){this.reset()})}}).fail(function(){console.log("error")}).always(function(){project.listproject()})}};
var employee={listEmployee:function(){$(".panel").removeClass("hide");document.getElementById("panel-heading").innerHTML="Employee";document.getElementById("panel-body").innerHTML='<table  id="tableEmployee" class="table table-condensed table-striped"></table><button id="addButton" class="btn btn-circle btn-lg" data-toggle="modal" data-target="#new-employee">Add</button>';$.ajax({url:"employee.php",dataType:"JSON",success:function(data){$("#tableEmployee").bootstrapTable({data:data,striped:true,columns:[{field:"employeeName",
title:"Name",align:"center",valign:"middle",sortable:true},{field:"employeeEmail",title:"Email",align:"center",valign:"middle",sortable:true},{field:"employeeFunction",title:"Function",align:"center",valign:"top",sortable:true},{field:"Project_NameProject",title:"Project",align:"center",valign:"middle",sortable:true},{field:"edit",title:"Edit",align:"center",valign:"middle"},{field:"delete",title:"Delete",align:"center",valign:"middle"}]});$("#tableEmployee").bootstrapTable("hideLoading")}}).done(function(){}).fail(function(){console.log("error")})},
addEmployee:function(){var formData=$("#cadEmployee").serialize();var data=formData;$.ajax({url:"addEmployee.php",type:"POST",dataType:"html",data:data}).done(function(){$("#cadEmployee").each(function(){this.reset()})}).fail(function(){console.log("error")}).always(function(){employee.listEmployee()})},clearModalEmployee:function(){$("#cadEmployee").each(function(){this.reset()})},modalEditarEmployee:function(id){var element=document.getElementById("editarEmployeeBody");$.ajax({url:"editarEmployeeModal.php",
type:"POST",data:"employeeEmail="+id}).done(function(msg){element.innerHTML=[msg];$("#editEmployee").modal("show")}).fail(function(){console.log("error")})},editarEmployee:function(){var formData=$("#eidtarEmployee").serialize();$.ajax({url:"editarEmployee.php",type:"POST",data:formData}).done(function(msg){if(msg=="Usu\u00e1rio est\u00e1 relacionado a um projeto!")alert(msg);$("#editEmployee").modal("hide");employee.listEmployee()}).fail(function(){console.log("error")})},deleteEmployee:function(id){$("#deletar").modal("show");
$(document).ready(function(){$("#deletarYes").click(function(){$.ajax({url:"deleteEmployee.php",type:"POST",data:"employeeEmail="+id}).done(function(msg){if(msg=="User is in a project!"){$("#notificacoes").modal("show");document.getElementById("notificationText").innerText=msg;document.getElementById("notificationText").margin=0}else console.log(msg);employee.listEmployee()}).fail(function(){console.log("error")})})})}};
var team={listTeam:function(){$("#finalizeButton").addClass("hide");if(document.getElementById("projectSelected").innerText!="Project Selected"){var projetoEscolhido=document.getElementById("projectSelected").innerHTML;$.ajax({url:"listTeam.php",type:"POST",data:"nameProject="+projetoEscolhido}).done(function(msg){document.getElementById("panel-heading").innerHTML="Team";document.getElementById("panel-body").innerHTML=[msg];$.ajax({url:"listScrumMaster.php"}).done(function(employeeScrumMaster){document.getElementById("inputScrumMaster").innerHTML=
employeeScrumMaster;$.ajax({url:"listDevelopmentTeam.php"}).done(function(msg){document.getElementById("inputDeveloperName").innerHTML=msg}).fail(function(){console.log("error")})}).fail(function(){console.log("error")})}).fail(function(){console.log("error")})}else{document.getElementById("notificationText").innerHTML="Please select a project!";$("#notificacoes").modal("show")}},addDevelopmenteTeam:function(){var inputProjectName=document.getElementById("projectSelected").innerHTML;var formDevelopmentTeam=
$("#cadDevelopmenteTeam").serialize();if(formDevelopmentTeam==="")alert("You need to select a employee");else{var data="inputProjectName="+encodeURIComponent(inputProjectName)+"&"+formDevelopmentTeam;$.ajax({url:"addDevelopmentTeam.php",type:"POST",data:data}).done(function(){team.listTeam()}).fail(function(){console.log("error")})}},addScrumMaster:function(){var inputProjectName=document.getElementById("projectSelected").innerHTML;var scrumMaster=$("#cadScrumMaster").serialize();if(scrumMaster===
"")alert("You need to select a employee");else{var data="inputProjectName="+encodeURIComponent(inputProjectName)+"&"+scrumMaster;$.ajax({url:"addScrumMaster.php",type:"POST",data:data}).done(function(){team.listTeam();$("#addScrumMaster").modal("hide")}).fail(function(){console.log("error")})}},removerEditarProductOwner:function(){$("#editProductOwner").modal("hide");$("#editarProductOwner").remove();team.listTeam()},editProductOwner:function(){var inputProjectName=document.getElementById("projectSelected").innerHTML;
var productOwner=$("#editarProductOwner").serialize();var data="inputProjectName="+encodeURIComponent(inputProjectName)+"&"+productOwner;$.ajax({url:"editarProductOwner.php",type:"POST",data:data}).done(function(){team.listTeam()}).fail(function(){console.log("error")})},receberEditProductOwner:function(){var inputProjectName=document.getElementById("projectSelected").innerHTML;var element=document.getElementById("editProductOwnerBody");$.ajax({url:"receberProductOwner.php",type:"POST",data:"name="+
inputProjectName}).done(function(msg){element.innerHTML=[msg];$("#editProductOwner").modal("show")}).fail(function(){console.log("error")})}};function stateFormatter(value,row){if(row.statusProductBacklog==="success")return{classes:row.statusProductBacklog,disabled:true};return value}function getTodayDateSprint(){var today=new Date;var dd=today.getDate();var mm=today.getMonth()+1;var yyyy=today.getFullYear();if(dd<10)dd="0"+dd;if(mm<10)mm="0"+mm;today=yyyy+"-"+mm+"-"+dd;return today}
function getDateSprintEnd(weeks){var time;if(weeks==="inputSprintTime=2")time=new Date(+new Date+121E7);else if(weeks==="inputSprintTime=3")time=new Date(+new Date+1814E6);else time=new Date(+new Date+2419E6);var dd=time.getDate();var mm=time.getMonth()+1;var yyyy=time.getFullYear();if(dd<10)dd="0"+dd;if(mm<10)mm="0"+mm;time=yyyy+"-"+mm+"-"+dd;return time}
function detailFormatter(index,row){var html=[];$.each(row,function(key,value){if(key=="ProductBacklogDescription"||key=="table_comment")html.push("<p><b>Description: </b></p><p>"+value+"</p>")});return html.join("")}
var productBacklog={listProductBacklog:function(){if(document.getElementById("projectSelected").innerText!="Project Selected"){$(".panel").removeClass("hide");document.getElementById("panel-heading").innerHTML="Product Backlog";$.ajax({url:"backlog.php",dataType:"JSON",type:"POST",data:"nameProject="+document.getElementById("projectSelected").innerHTML,success:function(data){document.getElementById("panel-body").innerHTML='<table class="table table-condensed" id="tableBacklog"></table><button id="addButton" class="btn btn-circle btn-lg" data-toggle="modal" data-target="#new-backLog">Add</button><button id="finalizeButton" name="finalizeButton" class="btn btn-circle btn-lg" onclick="productBacklog.addToSprint();">Start Sprint</button>';
$("#tableBacklog").bootstrapTable({data:data,detailView:true,detailFormatter:"detailFormatter",rowStyle:function(row,index){return{classes:data[index].statusProductBacklog}},columns:[{field:"state",checkbox:true,formatter:"stateFormatter"},{field:"productBacklogItem",title:"Name",align:"center",valign:"middle",sortable:true},{field:"PlanningPoker",title:"Planning Poker",align:"center",valign:"middle",sortable:true},{field:"edit",title:"Edit",align:"center",valign:"middle"},{field:"delete",title:"Delete",
align:"center",valign:"middle"}]});$("#tableBacklog").bootstrapTable("hideLoading")}}).done(function(){console.log("success")}).fail(function(){console.log("erro")})}else{document.getElementById("notificationText").innerHTML="Please select a project!";$("#notificacoes").modal("show")}},clearModalBackLog:function(){$("#cadBackLog").each(function(){this.reset()});productBacklog.listProductBacklog()},changeStatusBackLog:function(novoStatus,idBackLog){var data="inputBackLogName="+encodeURIComponent(idBackLog)+
"&"+"status="+encodeURIComponent(novoStatus);$.ajax({url:"alteraStatusBackLog.php",type:"POST",data:data}).done(function(){console.log("success");productBacklog.listProductBacklog()}).fail(function(){console.log("error")})},addBackLog:function(){var inputProjectName=document.getElementById("projectSelected").innerHTML;var formData=$("#cadBackLog").serialize();var data="inputProjectName="+encodeURIComponent(inputProjectName)+"&"+formData;$.ajax({url:"addBacklog.php",type:"POST",dataType:"html",data:data}).done(function(){productBacklog.listProductBacklog();
$("#cadBackLog").each(function(){this.reset()})}).fail(function(){console.log("error")})},editarBacklogModal:function(name){var inputProjectName=document.getElementById("projectSelected").innerHTML;var data="bakclogName="+encodeURIComponent(name)+"&"+"inputProjectName="+encodeURIComponent(inputProjectName);$.ajax({url:"editarBacklogModal.php",type:"POST",data:data}).done(function(msg){document.getElementById("editarBacklog").innerHTML=msg;$("#edit-backLog").modal("show")}).fail(function(){console.log("error")})},
editBacklog:function(name){var inputProjectName=document.getElementById("projectSelected").innerHTML;var editBackLog=$("#editBackLog").serialize();var data="inputProjectName="+encodeURIComponent(inputProjectName)+"&"+"inputBackLogName="+encodeURIComponent(name)+"&"+editBackLog;$.ajax({url:"editarBacklog.php",type:"POST",data:data}).done(function(){console.log("success");productBacklog.listProductBacklog();$("#edit-backLog").modal("hide")}).fail(function(){console.log("error")})},addToSprint:function(){var inputProjectName=
document.getElementById("projectSelected").innerHTML;if($("#tableBacklog").bootstrapTable("getSelections").length===0){document.getElementById("notificationText").innerHTML="You need to select an item!";$("#notificacoes").modal("show")}else{var projetoEscolhido=document.getElementById("projectSelected").innerHTML;$.ajax({url:"verificarSprint.php",type:"POST",data:{inputProjectName:projetoEscolhido}}).done(function(msg){if(msg==="true "){document.getElementById("notificationText").innerHTML="Sprint already started!";
$("#notificacoes").modal("show")}else{$("#new-timeSprint").modal("show");document.getElementById("submitSprintTime").onclick=function(){var sprintTime=$("#cadTimeSprint").serialize();var today=getTodayDateSprint();var end=getDateSprintEnd(sprintTime);var sprintTimeUpdate="inputProjectName="+encodeURIComponent(inputProjectName)+"&"+sprintTime+"&inputTodaySprint="+encodeURIComponent(today)+"&inputEndSprint="+encodeURIComponent(end);$.ajax({url:"updateSprintTime.php",type:"POST",data:sprintTimeUpdate}).done(function(){$("#tableBacklog").bootstrapTable("getSelections").forEach(function(element){var teste=
"inputProjectName="+encodeURIComponent(inputProjectName)+"&"+"productBacklogcolItem="+encodeURIComponent(element.productBacklogItem);$.ajax({url:"addToSprint.php",type:"POST",data:teste}).done(function(){console.log("success");var status="inputProjectName="+encodeURIComponent(inputProjectName);$.ajax({url:"statusSprint.php",type:"POST",data:status}).done(function(){}).fail(function(){console.log("error")})}).fail(function(){console.log("error")})});productBacklog.listProductBacklog();$("#new-timeSprint").modal("hide")}).fail(function(){console.log("error")})}}}).fail(function(){console.log("error")})}},
deleteBacklogItem:function(idBacklog){var inputProjectName=document.getElementById("projectSelected").innerHTML;var Row=document.getElementById(idBacklog);var Cell=Row.closest("tr");var data="inputProjectName="+encodeURIComponent(inputProjectName)+"&"+"keyBacklog="+encodeURIComponent(idBacklog);if(Cell.className=="warning"||Cell.className=="success")alert("The item was used!");else{$("#deletar").modal("show");$(document).ready(function(){$("#deletarYes").click(function(){$.ajax({url:"deleteBacklogItem.php",
type:"POST",data:data}).done(function(){productBacklog.listProductBacklog()}).fail(function(){console.log("error")})})})}}};
var bugTraker={listBugTraker:function(){$("#finalizeButton").addClass("hide");var projetoEscolhido=document.getElementById("projectSelected");if(projetoEscolhido.innerText!="Project Selected")if($("#projectSelected").hasClass("projectSelectedEmployee"))$.ajax({url:"listBugTraker.php",type:"POST",data:"nameProject="+projetoEscolhido.innerHTML}).done(function(msg){$(".panel").removeClass("hide");$("#addButton").attr("data-target","#new-bugTraker");document.getElementById("panel-heading").innerHTML=
"Bug Traker";document.getElementById("panel-body").innerHTML=[msg];alert(msg);var data="inputProjectName="+encodeURIComponent(projetoEscolhido);$.ajax({url:"listEmployeeBugTrakerDevelopmentTeam.php",type:"POST",data:data}).done(function(msg){document.getElementById("inputBugTrakerUserName").innerHTML=msg}).fail(function(){console.log("error")})}).fail(function(){console.log("error")});else $.ajax({url:"listBugTraker.php",type:"POST",dataType:"HTML",data:"nameProject="+projetoEscolhido.innerHTML}).done(function(msg){$(".panel").removeClass("hide");
$("#addButton").removeClass("hide");$("#addButton").attr("data-target","#new-bugTraker");document.getElementById("panel-heading").innerHTML="Bug Traker";document.getElementById("panel-body").innerHTML=msg;var data="inputProjectName="+encodeURIComponent(projetoEscolhido);$.ajax({url:"listSprintBugTraker.php",type:"POST",data:data}).done(function(msg){document.getElementById("inputBugTrakerItem").innerHTML=msg}).fail(function(){console.log("error")})}).fail(function(jqXHR,textStatus){alert("Request failed: "+
textStatus)});else{document.getElementById("notificationText").innerHTML="Please select a project!";$("#notificacoes").modal("show")}},clearModalBugTraker:function(){$("#cadBugTraker").each(function(){this.reset()});bugTraker.listBugTraker()},changeStatus:function(novoStatus,idBug){var inputProjectName=document.getElementById("projectSelected").innerHTML;var data="inputBugName="+encodeURIComponent(idBug)+"&"+"status="+encodeURIComponent(novoStatus)+"&"+"inputProjectName="+encodeURIComponent(inputProjectName);
$.ajax({url:"alterarStatusBugTraker.php",type:"POST",data:data}).done(function(){bugTraker.listBugTraker()}).fail(function(){console.log("error")})},addBugTraker:function(){var inputProjectName=document.getElementById("projectSelected").innerHTML;var formData=$("#cadBugTraker").serialize();var data="inputProjectName="+encodeURIComponent(inputProjectName)+"&"+formData;$.ajax({url:"addBugTraker.php",type:"POST",data:data}).done(function(){bugTraker.listBugTraker();$("#cadBugTraker").each(function(){this.reset()})}).fail(function(){console.log("error")})}};
var sprint={listSprint:function(){var projetoEscolhido=document.getElementById("projectSelected");if(projetoEscolhido.innerText!="Project Selected")if(projetoEscolhido.hasClass("projectSelectedEmployee"))$.ajax({url:"sprintEmployee.php",type:"POST",data:"nameProject="+projetoEscolhido.innerHTML}).done(function(msg){$("#finalizeButton").addClass("hide");document.getElementById("panel-heading").innerHTML="Sprint";document.getElementById("panel-body").innerHTML=[msg];$(".cardSprint").draggable({revert:"invalid",
snap:".bodySprint",stack:".cardSprint",containment:"document"});$(".bodySprint").droppable({tolerance:"pointer",drop:function(event,ui){var id=$(ui.draggable).attr("id");var box=$(this).attr("id");var data="inputProjectName="+encodeURIComponent(projetoEscolhido)+"&"+"id="+encodeURIComponent(id)+"&"+"box="+encodeURIComponent(box);$.ajax({url:"changeKanban.php",type:"POST",data:data}).done(function(){$("#sprint").click()}).fail(function(){console.log("error")})}})}).fail(function(){console.log("error")});
else $.ajax({url:"sprint.php",type:"POST",data:"nameProject="+projetoEscolhido.innerHTML}).done(function(msg){$("#finalizeButton").addClass("hide");document.getElementById("panel-heading").innerHTML="Sprint";document.getElementById("panel-body").innerHTML=[msg];$(".cardSprint").draggable({revert:"invalid",snap:".bodySprint",stack:".cardSprint",containment:"document"});$(".bodySprint").droppable({tolerance:"pointer",drop:function(event,ui){var id=$(ui.draggable).attr("id");var box=$(this).attr("id");
var data="inputProjectName="+encodeURIComponent(projetoEscolhido)+"&"+"id="+encodeURIComponent(id)+"&"+"box="+encodeURIComponent(box);$.ajax({url:"changeKanban.php",type:"POST",data:data}).done(function(){$("#sprint").click()}).fail(function(){console.log("error")})}})}).fail(function(){console.log("error")});else{document.getElementById("notificationText").innerHTML="Please select a project!";$("#notificacoes").modal("show")}},finalizeSprint:function(idSprint){var inputProjectName=document.getElementById("projectSelected").innerHTML;
var data="idSprint="+encodeURIComponent(idSprint)+"&"+"inputProjectName="+encodeURIComponent(inputProjectName);$.ajax({url:"finalizeSprint.php",type:"POST",data:data}).done(function(msg){console.log(msg);sprint.listSprint()}).fail(function(){console.log("error")})}};
var meeting={listMeeting:function(){$("#finalizeButton").addClass("hide");if(document.getElementById("projectSelected").innerText!="Project Selected"){var projetoEscolhido=document.getElementById("projectSelected").innerHTML;$.ajax({url:"listMeeting.php",type:"POST",dataType:"HTML",data:"nameProject="+projetoEscolhido}).done(function(msg){$(".panel").removeClass("hide");$("#addButton").removeClass("hide");$("#addButton").attr("data-target","#new-meeting");document.getElementById("panel-heading").innerHTML=
"Meetings";document.getElementById("panel-body").innerHTML=[msg];$.ajax({url:"listScrumTeam.php",type:"POST",dataType:"HTML",data:"nameProject="+projetoEscolhido}).done(function(scrumTeam){document.getElementById("inputMembersMeeting").innerHTML=scrumTeam}).fail(function(){console.log("error")})}).fail(function(jqXHR,textStatus){alert("Request failed: "+textStatus)})}else{document.getElementById("notificationText").innerHTML="Please select a project!";$("#notificacoes").modal("show")}},clearModalMeeting:function(){$("#cadMeeting").each(function(){this.reset()});
meeting.listMeeting()},addMeeting:function(){var inputProjectName=document.getElementById("projectSelected").innerHTML;var obj={};var formData=$("#cadMeeting").serializeArray();$.each(formData,function(){if(obj[this.name]!==undefined){if(!obj[this.name].push)obj[this.name]=[obj[this.name]];obj[this.name].push(this.value||"")}else obj[this.name]=this.value||""});obj.inputProjectName=inputProjectName;var data=JSON.stringify(obj);console.log(obj);$.ajax({url:"addMeeting.php",type:"POST",data:data}).done(function(msg){console.log(msg)}).fail(function(msg){console.log(msg)}).always(function(){$(".ui.dropdown").dropdown("clear");
$("#cadMeeting").each(function(){this.reset()});meeting.listMeeting()})}};
var charts={projectCharts:function(){var projetoEscolhido=document.getElementById("projectSelected").innerHTML;$.ajax({url:"backlogItensValues.php",type:"POST",dataType:"JSON",data:{projectSelected:projetoEscolhido}}).done(function(msg){var pointsToDo=0;var pointsDone=0;var timeDiff;var timeDiffDone;msg.forEach(function(element){console.log(element);pointsToDo+=parseInt(element.PlanningPoker);console.log(pointsToDo);var date1=new Date(element.SprintStarted);var date2=new Date(element.SprintTime);
if(element.statusProductBacklog==="success"){pointsDone+=parseInt(element.PlanningPoker);timeDiffDone=Math.abs(date2.getTime()-date1.getTime())}else timeDiff=Math.abs(date2.getTime()-date1.getTime())});var diffDays=Math.ceil(timeDiff/(1E3*3600*24));alert(diffDays);var expectation=pointsToDo/diffDays;var dados=[];var ponto;for(var i=0;i<=diffDays;i++){if(pointsToDo<0)ponto=[i,0];else ponto=[i,pointsToDo];dados.push(ponto);pointsToDo=pointsToDo-expectation}var data=new google.visualization.DataTable;
data.addColumn("number","Day");data.addColumn("number","Expectation");data.addRows(dados);var options={chart:{title:"Line Chart about Sprint"},height:500};var chart=new google.charts.Line(document.getElementById("panel-body"));chart.draw(data,options)}).fail(function(){console.log("error")})}};
function selectProjectEmployee(row){var Row=document.getElementsByTagName("tr")[row].getAttribute("data-index");var Cell=Row.getElementById(Row);$("#projectSelected").addClass("projectSelectedEmployee");document.getElementById("projectSelected").innerHTML=Cell[1].innerText}
function addBackLogEmployee(){var inputProjectName=document.getElementById("projectSelected").innerHTML;var formData=$("#cadBackLogEmployee").serialize();var data="inputProjectName="+encodeURIComponent(inputProjectName)+"&"+formData;$.ajax({url:"addBacklogEmployee.php",type:"POST",dataType:"html",data:data}).done(function(){console.log("success")}).fail(function(){console.log("error")}).always(function(){$("#cadBackLogEmployee").each(function(){this.reset()});myHeading("Backlog")})}
function addToSprintEmployee(){var inputProjectName=document.getElementById("projectSelected").innerHTML;idBacklogSelecionado.forEach(function(element){var data="inputProjectName="+encodeURIComponent(inputProjectName)+"&"+"productBacklogcolItem="+encodeURIComponent(element);$.ajax({url:"addToSprintEmployee.php",type:"POST",data:data}).done(function(){console.log("success");console.log(idBacklogSelecionado)}).fail(function(){console.log("error")}).always(function(){})})};